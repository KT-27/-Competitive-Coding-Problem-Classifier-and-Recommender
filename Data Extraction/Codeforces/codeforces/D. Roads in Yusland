(iCodeforcesProblem
CodeforcesProblem
p0
(dp1
S'desription'
p2
VD. Roads in Yusland\u000atime limit per test4 seconds\u000amemory limit per test256 megabytes\u000ainputstandard input\u000aoutputstandard output\u000aMayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.\u000aYusland consists of n intersections connected by n\u2009-\u20091 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.\u000aThere is only one road repairing company in town, named "RC company". Company's center is located at the intersection 1. RC company doesn't repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1.\u000aMayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It's allowed that some roads will be repaired more than once.\u000aIf it's impossible to repair all roads print \u2009-\u20091.\u000aInput\u000aThe first line of the input contains two integers n and m (1\u2009\u2264\u2009n,\u2009m\u2009\u2264\u2009300\u2009000) \u2014 the number of cities in Yusland and the number of workers respectively.\u000aThen follow n\u22121 line, each of them contains two integers xi and yi (1\u2009\u2264\u2009xi,\u2009yi\u2009\u2264\u2009n) \u2014 indices of intersections connected by the i-th road.\u000aLast m lines provide the description of workers, each line containing three integers ui, vi and ci (1\u2009\u2264\u2009ui,\u2009vi\u2009\u2264\u2009n, 1\u2009\u2264\u2009ci\u2009\u2264\u2009109). This means that the i-th worker can repair all roads on the path from vi to ui for ci coins. It's guaranteed that vi lies on the path from ui to 1. Note that vi and ui may coincide.\u000aOutput\u000aIf it's impossible to repair all roads then print \u2009-\u20091. Otherwise print a single integer \u2014 minimum cost required to repair all roads using "RC company" workers.\u000aExample\u000ainput\u000a6 5\u000a1 2\u000a1 3\u000a3 4\u000a4 5\u000a4 6\u000a2 1 2\u000a3 1 4\u000a4 1 3\u000a5 3 1\u000a6 3 2\u000aoutput\u000a8\u000aNote\u000aIn the first sample, we should choose workers with indices 1, 3, 4 and 5, some roads will be repaired more than once but it is OK. The cost will be equal to 2\u2009+\u20093\u2009+\u20091\u2009+\u20092\u2009=\u20098 coins.
p3
sS'problemStatement'
p4
VD. Roads in Yusland\u000atime limit per test4 seconds\u000amemory limit per test256 megabytes\u000ainputstandard input\u000aoutputstandard output\u000aMayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.\u000aYusland consists of n intersections connected by n\u2009-\u20091 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.\u000aThere is only one road repairing company in town, named "RC company". Company's center is located at the intersection 1. RC company doesn't repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1.\u000aMayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It's allowed that some roads will be repaired more than once.\u000aIf it's impossible to repair all roads print \u2009-\u20091.\u000aInput\u000aThe first line of the input contains two integers n and m (1\u2009\u2264\u2009n,\u2009m\u2009\u2264\u2009300\u2009000) \u2014 the number of cities in Yusland and the number of workers respectively.\u000aThen follow n\u22121 line, each of them contains two integers xi and yi (1\u2009\u2264\u2009xi,\u2009yi\u2009\u2264\u2009n) \u2014 indices of intersections connected by the i-th road.\u000aLast m lines provide the description of workers, each line containing three integers ui, vi and ci (1\u2009\u2264\u2009ui,\u2009vi\u2009\u2264\u2009n, 1\u2009\u2264\u2009ci\u2009\u2264\u2009109). This means that the i-th worker can repair all roads on the path from vi to ui for ci coins. It's guaranteed that vi lies on the path from ui to 1. Note that vi and ui may coincide.\u000aOutput\u000aIf it's impossible to repair all roads then print \u2009-\u20091. Otherwise print a single integer \u2014 minimum cost required to repair all roads using "RC company" workers.\u000aExample\u000ainput\u000a6 5\u000a1 2\u000a1 3\u000a3 4\u000a4 5\u000a4 6\u000a2 1 2\u000a3 1 4\u000a4 1 3\u000a5 3 1\u000a6 3 2\u000aoutput\u000a8\u000aNote\u000aIn the first sample, we should choose workers with indices 1, 3, 4 and 5, some roads will be repaired more than once but it is OK. The cost will be equal to 2\u2009+\u20093\u2009+\u20091\u2009+\u20092\u2009=\u20098 coins.
p5
sS'name'
p6
VD. Roads in Yusland
p7
sS'tags'
p8
Vdata structures dp greedy 
p9
sS'url'
p10
Vhttp://codeforces.com/problemset/problem/671/D
p11
sS'memorylimit'
p12
V256 megabytes
p13
sS'timelimit'
p14
V4 seconds
p15
sS'output'
p16
(lp17
VOutput
p18
aVIf it's impossible to repair all roads then print \u2009-\u20091. Otherwise print a single integer \u2014 minimum cost required to repair all roads using "RC company" workers.
p19
asS'statement'
p20
(lp21
VD. Roads in Yusland
p22
aVtime limit per test4 seconds
p23
aVmemory limit per test256 megabytes
p24
aVinputstandard input
p25
aVoutputstandard output
p26
aVMayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.
p27
aVYusland consists of n intersections connected by n\u2009-\u20091 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.
p28
aVThere is only one road repairing company in town, named "RC company". Company's center is located at the intersection 1. RC company doesn't repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1.
p29
aVMayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It's allowed that some roads will be repaired more than once.
p30
aVIf it's impossible to repair all roads print \u2009-\u20091.
p31
asS'problemId'
p32
V671/D
p33
sS'input'
p34
(lp35
VInput
p36
aVThe first line of the input contains two integers n and m (1\u2009\u2264\u2009n,\u2009m\u2009\u2264\u2009300\u2009000) \u2014 the number of cities in Yusland and the number of workers respectively.
p37
aVThen follow n\u22121 line, each of them contains two integers xi and yi (1\u2009\u2264\u2009xi,\u2009yi\u2009\u2264\u2009n) \u2014 indices of intersections connected by the i-th road.
p38
aVLast m lines provide the description of workers, each line containing three integers ui, vi and ci (1\u2009\u2264\u2009ui,\u2009vi\u2009\u2264\u2009n, 1\u2009\u2264\u2009ci\u2009\u2264\u2009109). This means that the i-th worker can repair all roads on the path from vi to ui for ci coins. It's guaranteed that vi lies on the path from ui to 1. Note that vi and ui may coincide.
p39
asS'id'
p40
c__builtin__
id
p41
sS'constraints'
p42
g35
sb.